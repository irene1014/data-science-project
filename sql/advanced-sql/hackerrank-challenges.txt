with k as (select h.hacker_id hacker_id,name,count(c.challenge_id) challenges_created from hackers hleft join challenges c on c.hacker_id=h.hacker_idgroup by h.hacker_id,name)select k.hacker_id,k.name,k.challenges_created from(with k as (select h.hacker_id hacker_id,name,count(c.challenge_id) challenges_created from hackers hleft join challenges c on c.hacker_id=h.hacker_idgroup by h.hacker_id,name)select challenges_created,count(*) from kgroup by challenges_createdhaving challenges_created=(select max(challenges_created)from k) or count(challenges_created)=1) pleft join k on k.challenges_created=p.challenges_createdorder by challenges_created desc, hacker_id;